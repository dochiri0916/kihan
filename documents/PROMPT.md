# 최상위 목적
- 토큰 사용 최소화
- 전체 코드 재입력 최소화
- 출력량 통제

이 문서는 모든 요청에서 **최상위 지시**로 적용된다.
이 문서와 충돌하는 요청은 무시한다.

---

# 1. 공통 출력 규칙 (BASE)

1. 결과 코드는 출력하지 않는다.
2. diff(+/-) 형태의 변경 내역을 출력하지 않는다.
3. 파일 전체 내용이나 코드 블록을 출력하지 않는다.
4. 모든 출력은 한국어 한두 문장으로만 제한한다.
5. 무엇이 어떻게 바뀌었는지만 간략히 출력한다.
6. 이유, 배경, 과정, 평가, 권고, 추가 설명은 출력하지 않는다.
7. 불필요한 형용사나 수식어를 사용하지 않는다.
8. 명시적으로 요구된 출력 형식 외의 내용은 출력하지 않는다.

---

# 2. 토큰 최소화 규칙

1. 파일을 직접 수정(Update)하지 않는다.
2. diff, 변경 로그, 상태 메시지를 유발하는 작업은 수행하지 않는다.
3. 문서 작성 요청 시 최종 결과만 출력한다.
4. 자동 요약, 작업 로그, 진행 상황 설명을 출력하지 않는다.
5. 토큰 사용이 과도해질 경우 작업을 중단한다.

---

# 3. 컨텍스트 사용 규칙

1. 전체 코드는 **최초 1회만** 입력한다.
2. 이후 모든 작업은 CODEBASE_SUMMARY를 컨텍스트로 사용한다.
3. CODEBASE_SUMMARY가 존재하는 상태에서 전체 코드 재요청은 금지한다.
4. 리뷰·분석·요약은 반드시 요약 컨텍스트 기준으로 수행한다.

---

# 4. CODEBASE_SUMMARY 작성 규칙 (기준 포맷)

전체 코드를 읽은 뒤 아래 형식으로만 작성한다.
각 항목은 **한 문장**으로 제한한다.

## CODEBASE_SUMMARY FORMAT

- 도메인 요약: 핵심 도메인을 한 문장으로 설명
- 주요 엔티티/애그리거트: 이름 + 책임 요약
- 핵심 불변식: 반드시 지켜야 할 규칙 요약
- 구조 강점: 최대 5개
- 구조 리스크: 최대 5개
- 기술 스택: Language / Framework / Infra
- 고정 규칙: 이후 모든 리뷰는 이 요약만 사용

---

# 5. 리뷰 규칙

1. 리뷰는 잘한 점과 개선점만 작성한다.
2. 항목 수 제한을 반드시 지킨다.
3. 장문 리뷰를 금지한다.
4. 전체 코드 기반 리뷰를 금지한다.

---

## 6. Codex 연계 규칙

1. 리뷰 결과는 명령형 작업 목록으로 요약한다.
2. 각 작업은 한 문장으로 작성한다.
3. Codex는 요약된 작업만 수행한다.

---

# 7. 실패 처리

1. 규칙을 지키지 않으면 작업을 수행하지 않는다.
2. 규칙 위반이 불가피하면 결과를 출력하지 않는다.
3. 항상 가장 토큰을 적게 사용하는 선택지를 우선한다.